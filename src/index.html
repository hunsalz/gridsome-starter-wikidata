<!DOCTYPE html>
<html ${htmlAttrs}>

<head>
  ${head}
  <!-- Modern mobile web app meta tag (replaces deprecated apple-mobile-web-app-capable) -->
  <meta name="mobile-web-app-capable" content="yes">
  <!-- Preconnect to Google Fonts for faster font loading -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- DNS prefetch for external resources -->
  <link rel="dns-prefetch" href="https://www.wikidata.org">
</head>

<body ${bodyAttrs}>
  <script>
    // dark / light detection that runs before Vue.js load. Borrowed from overreacted.io
    (function () {
      window.__onThemeChange = function () { };
      function setTheme(newTheme) {
        window.__theme = newTheme;
        preferredTheme = newTheme;
        document.body.setAttribute('data-theme', newTheme);
        window.__onThemeChange(newTheme);
      }

      var preferredTheme;
      try {
        preferredTheme = localStorage.getItem('theme');
      } catch (err) { }

      window.__setPreferredTheme = function (newTheme) {
        setTheme(newTheme);
        try {
          localStorage.setItem('theme', newTheme);
        } catch (err) { }
      }

      var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
      // Use addEventListener instead of deprecated addListener
      if (darkQuery.addEventListener) {
        darkQuery.addEventListener('change', function (e) {
          window.__setPreferredTheme(e.matches ? 'dark' : 'light')
        });
      } else {
        // Fallback for older browsers
        darkQuery.addListener(function (e) {
          window.__setPreferredTheme(e.matches ? 'dark' : 'light')
        });
      }

      setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
    })();
  </script>

  ${app}
  ${scripts}
</body>

</html>